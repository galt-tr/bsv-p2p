"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const MonitorDaemon_1 = require("../MonitorDaemon");
const Services_1 = require("../../services/Services");
const TestUtilsWalletStorage_1 = require("../../../test/utils/TestUtilsWalletStorage");
const createDefaultNoDbChaintracksOptions_1 = require("../../services/chaintracker/chaintracks/createDefaultNoDbChaintracksOptions");
const Chaintracks_1 = require("../../services/chaintracker/chaintracks/Chaintracks");
describe('MonitorDaemon tests', () => {
    jest.setTimeout(99999999);
    test('0 mainnet', async () => {
        await test0Body('main');
    });
    test('0a testnet', async () => {
        await test0Body('test');
    });
    async function test0Body(chain) {
        const env = TestUtilsWalletStorage_1._tu.getEnv(chain);
        const servicesOptions = Services_1.Services.createDefaultOptions(chain);
        if (env.taalApiKey) {
            servicesOptions.taalApiKey = env.taalApiKey;
            servicesOptions.arcConfig.apiKey = env.taalApiKey;
        }
        if (env.whatsonchainApiKey)
            servicesOptions.whatsOnChainApiKey = env.whatsonchainApiKey;
        if (env.bitailsApiKey)
            servicesOptions.bitailsApiKey = env.bitailsApiKey;
        const u = undefined;
        const maxRetained = 32;
        const chaintracksOptions = (0, createDefaultNoDbChaintracksOptions_1.createDefaultNoDbChaintracksOptions)(chain, env.whatsonchainApiKey, u, maxRetained);
        const chaintracks = new Chaintracks_1.Chaintracks(chaintracksOptions);
        servicesOptions.chaintracks = chaintracks;
        const d = new MonitorDaemon_1.MonitorDaemon({
            chain: 'test',
            mySQLConnection: env.cloudMySQLConnection,
            servicesOptions,
            chaintracks
        });
        await d.runDaemon();
    }
});
//# sourceMappingURL=MonitorDaemon.man.test.js.map